<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç API - –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #d4d4d4; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; }
        pre { background: #2d2d2d; padding: 15px; border-radius: 5px; overflow-x: auto; }
        .success { color: #4ec9b0; }
        .error { color: #f48771; }
        .info { color: #569cd6; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç API - –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã AI –∞–Ω–∞–ª–∏–∑–∞</h1>

    <div>
        <h2>1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h2>
        <button onclick="testGetSavedResults()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ü–†–ò–ó–´–í–ù–ò–ö #11)</button>
        <pre id="result1"></pre>
    </div>

    <div>
        <h2>2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø—Ä–∏–∑—ã–≤–Ω–∏–∫–æ–≤</h2>
        <button onclick="testGetConscripts()">–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑—ã–≤–Ω–∏–∫–æ–≤</button>
        <pre id="result2"></pre>
    </div>

    <script>
        const API_URL = 'http://localhost:8000';
        const CONSCRIPT_DRAFT_ID = '1068ed31-719d-48ff-9b9b-1133e3ea5735'; // –¢–ï–°–¢–û–í–´–ô –ü–†–ò–ó–´–í–ù–ò–ö #11

        async function testGetSavedResults() {
            const output = document.getElementById('result1');
            output.innerHTML = '<span class="info">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</span>';

            try {
                const response = await fetch(`${API_URL}/api/v1/validation/saved-analysis/${CONSCRIPT_DRAFT_ID}`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                output.innerHTML = `
<span class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!</span>

<span class="info">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:</span> ${data.total_count}

<span class="info">–ü—Ä–∏–∑—ã–≤–Ω–∏–∫ draft_id:</span> ${CONSCRIPT_DRAFT_ID}

<span class="info">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:</span>
${JSON.stringify(data, null, 2)}
                `.trim();

            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</span>`;
            }
        }

        async function testGetConscripts() {
            const output = document.getElementById('result2');
            output.innerHTML = '<span class="info">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</span>';

            try {
                const response = await fetch(`${API_URL}/api/v1/conscripts/?limit=5`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                output.innerHTML = `
<span class="success">‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!</span>

<span class="info">–í—Å–µ–≥–æ –ø—Ä–∏–∑—ã–≤–Ω–∏–∫–æ–≤:</span> ${data.total}

<span class="info">–ü–µ—Ä–≤—ã–µ 5 –ø—Ä–∏–∑—ã–≤–Ω–∏–∫–æ–≤:</span>
${data.conscripts.map(c => `
  ‚Ä¢ ${c.full_name}
    ID: ${c.id}
    IIN: ${c.iin}
`).join('\n')}
                `.trim();

            } catch (error) {
                output.innerHTML = `<span class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</span>`;
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = () => {
            console.log('üß™ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            console.log('API URL:', API_URL);
            console.log('Conscript Draft ID:', CONSCRIPT_DRAFT_ID);
        };
    </script>
</body>
</html>
